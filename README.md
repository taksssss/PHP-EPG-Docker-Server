# PHP-EPG-Docker-Server ğŸ“º
![Docker Pulls](https://img.shields.io/docker/pulls/taksss/php-epg)

PHP-EPG-Docker-Server æ˜¯ä¸€ä¸ªç”¨ PHP å®ç°çš„ EPGï¼ˆç”µå­èŠ‚ç›®æŒ‡å—ï¼‰æœåŠ¡ç«¯ï¼Œ `Docker` éƒ¨ç½²ï¼Œè‡ªå¸¦è®¾ç½®ç•Œé¢ï¼Œæ”¯æŒ `DIYP & ç™¾å·` ã€ `è¶…çº§ç›´æ’­` ä»¥åŠ `xmltv` æ ¼å¼ã€‚

## ä¸»è¦åŠŸèƒ½ â„¹ï¸
- **ä½¿ç”¨ DockerğŸ³ éƒ¨ç½²ï¼Œæä¾› `amd64` è·Ÿ `arm64` æ¶æ„é•œåƒ**
- **åŸºé•œåƒé‡‡ç”¨ `[alpine-apache-php](https://github.com/eriksoderblom/alpine-apache-php/)` ï¼Œå‹ç¼©åå¤§å°ä»… `23M`** ğŸ“¦
- **é‡‡ç”¨å…ˆæ„å»ºå†å­˜æ•°æ®åº“çš„ç­–ç•¥ï¼Œå ç”¨ç©ºé—´ç¨å¤§ï¼Œä½†æ˜¯èƒ½å®ç°ç§’è¯»å–** ğŸš€
- **æ”¯æŒ `DIYP & ç™¾å·` ä»¥åŠ `è¶…çº§ç›´æ’­` æ ¼å¼ï¼Œæ”¯æŒç¼“å­˜ `xmltv` æ ¼å¼** ğŸ“¡
- å…¼å®¹å¤šç§ `xmltv` æ ¼å¼ ğŸ“‘
- å†…ç½®å®šæ—¶ä»»åŠ¡ï¼Œæ”¯æŒè®¾ç½®å®šæ—¶æ‹‰å–æ•°æ® â³
- ä½¿ç”¨ `SQLite` æ•°æ®åº“å­˜å‚¨ ğŸ—ƒï¸
- åŒ…å«ç½‘é¡µè®¾ç½®é¡µé¢ ğŸŒ
- æ”¯æŒå¤šä¸ª EPG æº ğŸ“¡
- å¯é…ç½®æ•°æ®ä¿å­˜å¤©æ•° ğŸ“…
- æ”¯æŒè®¾ç½®é¢‘é“å¿½ç•¥å­—ç¬¦ä¸² ğŸ”‡
- æ”¯æŒé¢‘é“æ˜ å°„ï¼Œæ”¯æŒ**æ­£åˆ™è¡¨è¾¾å¼** ğŸ”„
- å†…ç½® `phpLiteAdmin` æ–¹ä¾¿ç®¡ç†æ•°æ®åº“ ğŸ› ï¸

![è®¾ç½®é¡µé¢](/pic/management.png)

![å®šæ—¶ä»»åŠ¡æ—¥å¿—](/pic/cronLog.png)

![æ›´æ–°æ—¥å¿—](/pic/updateLog.png)

> **å†…ç½®æ­£åˆ™è¡¨è¾¾å¼è¯´æ˜ï¼š**
> 
> - ä»¥ `regex:` ä½œä¸ºå‰ç¼€
> 
> - ç¤ºä¾‹ï¼š
> 
>   - `regex:/^CCTV[-\s]*(\p{Han})/iu, $1` ï¼šå°† `CCTVé£äº‘è¶³çƒ`ã€`cctv-é£äº‘éŸ³ä¹` ç­‰æ›¿æ¢æˆ `é£äº‘è¶³çƒ`ã€`é£äº‘éŸ³ä¹`
> 
>   - `regex:/^CCTV[-\s]*(\d+[K\+]?)(?!ç¾æ´²|æ¬§æ´²).*/i, CCTV$1` ï¼šå°† `CCTV 1ç»¼åˆ`ã€`CCTV-4Ké¢‘é“`ã€`CCTV - 5+é¢‘é“` ç­‰æ›¿æ¢æˆ `CCTV1`ã€`CCTV4K`ã€`CCTV5+`ï¼ˆæ’é™¤ `CCTV4ç¾æ´²` å’Œ `CCTV4æ¬§æ´²`ï¼‰
> 
>   - `regex:/^(æ·±åœ³.*?)é¢‘é“$/i, $1` ï¼šå°† `æ·±åœ³xxé¢‘é“` æ›¿æ¢æˆ `æ·±åœ³xx`

## æ›´æ–°æ—¥å¿— ğŸ“

### 2024-7-21æ›´æ–°ï¼š

1. **æ”¯æŒ `è¶…çº§ç›´æ’­` æ ¼å¼**
2. **é‡æ„ä»£ç ï¼ŒåŸºé•œåƒæ”¹ä¸º `alpine-apache-php` ï¼Œé•œåƒå¤§å°ä» 155M ä¸‹é™åˆ° 23M**
3. æ”¯æŒè§£æ M3U4U ç­‰é .xml/.gz ç»“å°¾ EPG åœ°å€
4. æ•°æ®åˆ†æ‰¹æ’å…¥ï¼Œé™ä½å†…å­˜å ç”¨
5. ä¿®å¤éƒ¨åˆ†ç•Œé¢æ˜¾ç¤ºå¼‚å¸¸é—®é¢˜
6. ä¿®å¤è®¾ç½®é¡µé¢åˆ·æ–°ï¼Œæç¤ºâ€œæ˜¯å¦é‡æ–°æäº¤è¡¨å•â€é—®é¢˜
7. å¢åŠ æ¥å£æµ‹è¯•è¯´æ˜
8. å¢åŠ  EPG åœ°å€å¡«å†™æç¤º

- âš ï¸ è¯¥ç‰ˆæœ¬å®¹å™¨å†…ç«¯å£ä» `8080` ä¿®æ­£ä¸º `80`ï¼Œè‡ªè¡Œéƒ¨ç½²çš„å°ä¼™ä¼´æ³¨æ„è¿™ä¸€ç‚¹ã€‚


#### TODOï¼š

- æ”¯æŒç¹ä½“é¢‘é“åŒ¹é…ï¼ˆ opencc4php åœ¨ alpine é‡Œé¢è¿˜æ²¡è·‘èµ·æ¥â€¦â€¦ï¼‰
- æ•´åˆç”Ÿæˆ xml æ–‡ä»¶ï¼ˆç°åœ¨åªè¿”å›ç¬¬ä¸€ä¸ªï¼‰
- æ”¯æŒå¤šå¯¹ä¸€é¢‘é“æ˜ å°„

### 2024-7-18æ›´æ–°ï¼š

1. æä¾› DockerğŸ³ é•œåƒï¼ˆåŸºäº php:7.4-apache ï¼Œæ”¯æŒ x86-64 è·Ÿ arm64 ï¼‰
2. æ”¯æŒå®šæ—¶æ›´æ–°æ•°æ®åº“
3. EPG æºæ”¯æŒæ·»åŠ æ³¨é‡Š
4. æ”¯æŒæ›´æ”¹ç™»å½•å¯†ç  ã€é»˜è®¤ä¸ºç©ºï¼ï¼ï¼ã€‘
5. æ”¯æŒæŸ¥çœ‹å®šæ—¶ä»»åŠ¡æ—¥å¿—
6. æ”¯æŒæŸ¥çœ‹æ•°æ®åº“æ›´æ–°æ—¥å¿—
7. é…ç½®é¡µé¢æ”¯æŒ Ctrl+S ä¿å­˜
8. æ›´æ–°éƒ¨ç½²æµç¨‹


### 2024-7-14æ›´æ–°ï¼š

1. æ”¹ç”¨ Docker ComposeğŸ³ éƒ¨ç½²
2. æ›´æ–°éƒ¨ç½²æµç¨‹

### 2024-7-13æ›´æ–°ï¼š

1. ä¼˜åŒ–è‡ªå¸¦æ­£åˆ™è¡¨è¾¾å¼
2. æ›´æ–°é»˜è®¤è¿”å›æ•°æ®ï¼Œä¾›å›æ”¾ä½¿ç”¨
3. å¢åŠ  TiviMate ç¤ºä¾‹å›¾ç‰‡

### 2024-7-13åˆå§‹ç‰ˆæœ¬ï¼š

1. æ”¯æŒæ ‡å‡† xmltv å’Œ DIYP&ç™¾å· æ ¼å¼
2. åŒ…å«ç½‘é¡µè®¾ç½®é¡µé¢
3. æ”¯æŒå¤šä¸ª EPG æº
4. å¯é…ç½®æ•°æ®ä¿å­˜å¤©æ•°
5. æ”¯æŒè®¾ç½®é¢‘é“å¿½ç•¥å­—ç¬¦ä¸²
6. æ”¯æŒé¢‘é“æ˜ å°„ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼
7. å†…ç½® phpLiteAdmin æ–¹ä¾¿ç®¡ç†æ•°æ®åº“


## éƒ¨ç½²æ­¥éª¤ ğŸš€

1. é…ç½® `Docker` ç¯å¢ƒ

2. è‹¥å·²å®‰è£…è¿‡ï¼Œå…ˆåˆ é™¤æ—§ç‰ˆæœ¬ï¼ˆæ³¨æ„å¤‡ä»½æ•°æ®ï¼‰

   ```bash
   docker rm php-epg -f
   ```

3. æ‹‰å–é•œåƒå¹¶è¿è¡Œï¼š

   ```bash
   docker run -d \
     --name php-epg \
     -p 5678:80 \
     --restart always \
     taksss/php-epg:latest
   ```

      >
      > é»˜è®¤ç«¯å£ä¸º `5678` ï¼Œæ ¹æ®éœ€è¦è‡ªè¡Œä¿®æ”¹ã€‚
      > 


## ä½¿ç”¨æ­¥éª¤ ğŸ› ï¸

1. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://{æœåŠ¡å™¨IPåœ°å€}:5678/epg/manage.php`

2. **é»˜è®¤å¯†ç ä¸ºç©º**ï¼Œæ ¹æ®éœ€è¦è‡ªè¡Œè®¾ç½®

3. æ·»åŠ  `EPG æºåœ°å€`ï¼Œ GitHub æºç¡®ä¿èƒ½å¤Ÿè®¿é—®ï¼Œç‚¹å‡» `æ›´æ–°é…ç½®` ä¿å­˜

4. ç‚¹å‡» `æ›´æ–°æ•°æ®åº“` æ‹‰å–æ•°æ®ï¼Œç‚¹å‡» `æ•°æ®åº“æ›´æ–°æ—¥å¿—` æŸ¥çœ‹æ—¥å¿—ï¼Œç‚¹å‡» `æŸ¥çœ‹æ•°æ®åº“` æŸ¥çœ‹å…·ä½“æ¡ç›®

5. è®¾ç½® `å®šæ—¶ä»»åŠ¡` ï¼Œç‚¹å‡» `æ›´æ–°é…ç½®` ä¿å­˜ï¼Œç‚¹å‡» `å®šæ—¶ä»»åŠ¡æ—¥å¿—` æŸ¥çœ‹å®šæ—¶ä»»åŠ¡æ—¶é—´è¡¨

6. ç”¨æµè§ˆå™¨æµ‹è¯•å„ä¸ªæ¥å£çš„è¿”å›ç»“æœæ˜¯å¦æ­£ç¡®ï¼š

    - `xmltv` æ¥å£ï¼š `http://{æœåŠ¡å™¨IPåœ°å€}:5678/epg/index.php`
  
    - `DIYP&ç™¾å·` æ¥å£ï¼š `http://{æœåŠ¡å™¨IPåœ°å€}:5678/epg/index.php?ch=CCTV1`
  
    - `è¶…çº§ç›´æ’­` æ¥å£ï¼š `http://{æœåŠ¡å™¨IPåœ°å€}:5678/epg/index.php?channel=CCTV1`

7. å°† **`http://{æœåŠ¡å™¨IPåœ°å€}:5678/epg/index.php`** å¡«å…¥ `DIYP`ã€`TiviMate` ç­‰è½¯ä»¶çš„ `EPG åœ°å€æ `

    - âš ï¸ ç›´æ¥ä½¿ç”¨ `docker run` æ‹‰å–é•œåƒçš„è¯ï¼Œå¯ä»¥å°† `http://{æœåŠ¡å™¨IPåœ°å€}:5678/epg/index.php` æ›¿æ¢ä¸º `http://{æœåŠ¡å™¨IPåœ°å€}:5678/epg`ã€‚

![è®¾ç½®å®šæ—¶ä»»åŠ¡](/pic/cronSet.png)

![æ›´æ–°æ•°æ®åº“](/pic/update.png)

![phpLiteAdmin](/pic/phpliteadmin.png)

## æ•ˆæœç¤ºä¾‹ ğŸ–¼ï¸

**DIYP**

![DIYP ç¤ºä¾‹](/pic/DIYP.png)

**TiviMate**

![TiviMate](/pic/TiviMate.jpg)

**è¶…çº§ç›´æ’­**
![è¶…çº§ç›´æ’­](/pic/LoveTV.jpg)

## ç‰¹åˆ«é¸£è°¢ ğŸ™
- [alpine-apache-php](https://github.com/eriksoderblom/alpine-apache-php/)
- [celetor/epg](https://github.com/celetor/epg)
- [sparkssssssssss/epg](https://github.com/sparkssssssssss/epg)
- [Black_crow/xmlgz](https://gitee.com/Black_crow/xmlgz)
- [112114](https://diyp.112114.xyz/)
- [EPG 51zmt](http://epg.51zmt.top:8000/)
